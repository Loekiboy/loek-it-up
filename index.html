<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loek it Up - Woordjes Leren</title>
    <link rel="icon" href="images/fav.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo" onclick="showHome()">
                <img src="images/logo-site.png" alt="Loek it Up Logo" class="logo-image">
                <span>Loek it Up</span>
            </div>
            <nav class="nav">
                <button class="nav-btn active" onclick="showHome()" data-view="home">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="nav-btn" onclick="showCreateList()" data-view="create">
                    <i class="fas fa-plus"></i> Nieuwe Lijst
                </button>
                <button class="nav-btn" onclick="openAppSettings()" data-view="settings">
                    <i class="fas fa-cog"></i> Instellingen
                </button>
            </nav>
            <div class="auth-controls cloud-only">
                <button id="auth-menu-btn" class="auth-avatar-btn" onclick="toggleAuthMenu(event)" aria-label="Account">
                    <img src="images/fav.png" alt="Account" class="auth-avatar-img">
                </button>
                <div id="auth-menu" class="auth-menu hidden">
                    <div id="auth-user" class="auth-user hidden"></div>
                    <button id="auth-login-btn" class="btn btn-secondary" onclick="openAuthModal('login')">
                        <i class="fas fa-sign-in-alt"></i> Inloggen
                    </button>
                    <button id="auth-signup-btn" class="btn btn-primary" onclick="openAuthModal('signup')">
                        <i class="fas fa-user-plus"></i> Account maken
                    </button>
                    <button id="auth-logout-btn" class="btn btn-secondary hidden" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Uitloggen
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home View -->
            <div id="home-view" class="view active">
                <div class="welcome-section">
                    <div class="welcome-icon">
                        <img src="images/fav.png" alt="Loek it Up Mascot">
                    </div>
                    <h1>Welkom bij <span class="highlight">Loek it Up</span></h1>
                    <p>De slimste manier om woordjes te leren!</p>
                </div>
                
                <div class="lists-section">
                    <h2><i class="fas fa-folder-open"></i> Mijn Woordenlijsten</h2>
                    <div class="public-search cloud-only">
                        <div class="public-search-bar">
                            <i class="fas fa-search"></i>
                            <input type="text" id="public-search-input" name="public-search" autocomplete="off" autocapitalize="none" spellcheck="false" data-lpignore="true" placeholder="Zoek openbare woordenlijsten (titel of woord)..." oninput="debouncedPublicSearch()">
                        </div>
                        <div id="public-search-results" class="public-search-results"></div>
                    </div>
                    <div id="word-lists-container" class="word-lists-grid">
                        <!-- Word lists will be dynamically added here -->
                    </div>
                    <div id="empty-state" class="empty-state">
                        <i class="fas fa-book"></i>
                        <h3>Nog geen woordenlijsten</h3>
                        <p>Maak je eerste woordenlijst om te beginnen met leren!</p>
                        <button class="btn btn-primary" onclick="showCreateList()">
                            <i class="fas fa-plus"></i> Nieuwe Lijst
                        </button>
                    </div>
                </div>
            </div>

            <!-- Create/Edit List View -->
            <div id="create-view" class="view">
                <div class="create-container">
                    <h2><i class="fas fa-edit"></i> <span id="create-title">Nieuwe Woordenlijst</span></h2>
                    
                    <div class="form-group">
                        <label for="list-title">Titel</label>
                        <input type="text" id="list-title" placeholder="Bijv. Franse woordjes Hoofdstuk 3">
                    </div>

                    <div class="form-group">
                        <label>Vak</label>
                        <div class="subject-selector">
                            <button class="subject-btn" data-subject="nederlands" data-icon="fa-flag">
                                <i class="fas fa-flag"></i> Nederlands
                            </button>
                            <button class="subject-btn" data-subject="engels" data-icon="fa-flag-usa">
                                <i class="fas fa-flag-usa"></i> Engels
                            </button>
                            <button class="subject-btn" data-subject="frans" data-icon="fa-flag">
                                <i class="fas fa-flag"></i> Frans
                            </button>
                            <button class="subject-btn" data-subject="duits" data-icon="fa-flag">
                                <i class="fas fa-flag"></i> Duits
                            </button>
                            <button class="subject-btn" data-subject="spaans" data-icon="fa-flag">
                                <i class="fas fa-flag"></i> Spaans
                            </button>
                            <button class="subject-btn" data-subject="italiaans" data-icon="fa-flag">
                                <i class="fas fa-flag"></i> Italiaans
                            </button>
                            <button class="subject-btn" data-subject="latijn" data-icon="fa-book-open">
                                <i class="fas fa-book-open"></i> Latijn
                            </button>
                            <button class="subject-btn" data-subject="grieks" data-icon="fa-university">
                                <i class="fas fa-university"></i> Grieks
                            </button>
                            <button class="subject-btn" data-subject="natuurkunde" data-icon="fa-atom">
                                <i class="fas fa-atom"></i> Natuurkunde
                            </button>
                            <button class="subject-btn" data-subject="scheikunde" data-icon="fa-flask">
                                <i class="fas fa-flask"></i> Scheikunde
                            </button>
                            <button class="subject-btn" data-subject="biologie" data-icon="fa-dna">
                                <i class="fas fa-dna"></i> Biologie
                            </button>
                            <button class="subject-btn" data-subject="other" data-icon="fa-book">
                                <i class="fas fa-book"></i> Overig
                            </button>
                        </div>
                        <input type="hidden" id="selected-subject" value="">
                        <input type="hidden" id="selected-icon" value="">
                    </div>

                    <div class="form-group">
                        <label>Talen</label>
                        <div class="language-inputs">
                            <div class="language-select-wrapper">
                                <input type="text" class="language-search" id="lang-from-search" name="lang-from-search" autocomplete="off" autocapitalize="none" spellcheck="false" data-lpignore="true" placeholder="Zoeken...">
                                <select id="lang-from" aria-label="Taal van">
                                    <option value="" selected disabled>Kies taal</option>
                                    <option>Nederlands</option>
                                    <option>Engels</option>
                                    <option>Frans</option>
                                    <option>Duits</option>
                                    <option>Spaans</option>
                                    <option>Italiaans</option>
                                    <option>Portugees</option>
                                    <option>Latijn</option>
                                    <option>Grieks</option>
                                    <option>Arabisch</option>
                                    <option>Turks</option>
                                    <option>Chinees</option>
                                    <option>Japans</option>
                                    <option>Koreaans</option>
                                    <option>Russisch</option>
                                    <option>Zweeds</option>
                                    <option>Deens</option>
                                    <option>Noors</option>
                                    <option>Overig</option>
                                </select>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                            <div class="language-select-wrapper">
                                <input type="text" class="language-search" id="lang-to-search" name="lang-to-search" autocomplete="off" autocapitalize="none" spellcheck="false" data-lpignore="true" placeholder="Zoeken...">
                                <select id="lang-to" aria-label="Taal naar">
                                    <option value="" selected disabled>Kies taal</option>
                                    <option>Nederlands</option>
                                    <option>Engels</option>
                                    <option>Frans</option>
                                    <option>Duits</option>
                                    <option>Spaans</option>
                                    <option>Italiaans</option>
                                    <option>Portugees</option>
                                    <option>Latijn</option>
                                    <option>Grieks</option>
                                    <option>Arabisch</option>
                                    <option>Turks</option>
                                    <option>Chinees</option>
                                    <option>Japans</option>
                                    <option>Koreaans</option>
                                    <option>Russisch</option>
                                    <option>Zweeds</option>
                                    <option>Deens</option>
                                    <option>Noors</option>
                                    <option>Overig</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group cloud-only">
                        <label class="toggle-label">
                            <input type="checkbox" id="list-public">
                            <span class="toggle-switch">
                                <span class="toggle-slider"></span>
                            </span>
                            <span class="toggle-text">Openbaar maken (anderen kunnen deze lijst vinden)</span>
                        </label>
                    </div>

                    <div class="import-section">
                        <button class="btn btn-secondary" onclick="toggleImport()">
                            <i class="fas fa-file-import"></i> Importeren
                        </button>
                        <div id="import-area" class="import-area hidden">
                            <p class="import-hint">Plak hier woordjes gescheiden door tabs (van StudyGo, Quizlet, etc.)</p>
                            <textarea id="import-text" placeholder="woord1&#9;vertaling1&#10;woord2&#9;vertaling2"></textarea>
                            <button class="btn btn-primary" onclick="importWords()">
                                <i class="fas fa-check"></i> Importeren
                            </button>
                        </div>
                    </div>

                    <div class="words-editor">
                        <h3>Woordjes</h3>
                        <div id="words-list" class="words-list">
                            <!-- Word entries will be added here -->
                        </div>
                        <button class="btn btn-add-word" onclick="addWordEntry()">
                            <i class="fas fa-plus"></i> Woord toevoegen
                        </button>
                    </div>

                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="showHome()">Annuleren</button>
                        <button class="btn btn-primary" onclick="saveList()">
                            <i class="fas fa-save"></i> Opslaan
                        </button>
                    </div>
                </div>
            </div>

            <!-- List Detail View -->
            <div id="list-view" class="view">
                <div class="list-detail-container">
                    <div class="list-header">
                        <button class="btn-back" onclick="showHome()">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <div class="list-info">
                            <div class="list-icon">
                                <i id="list-detail-icon" class="fas fa-book"></i>
                            </div>
                            <div>
                                <h2 id="list-detail-title">Woordenlijst</h2>
                                <p id="list-detail-meta">0 woordjes</p>
                            </div>
                        </div>
                        <div class="list-actions">
                            <button class="btn btn-icon" onclick="editCurrentList()" title="Bewerken">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-icon" onclick="exportCurrentList()" title="Exporteren">
                                <i class="fas fa-file-export"></i>
                            </button>
                            <button class="btn btn-icon btn-danger" onclick="deleteCurrentList()" title="Verwijderen">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>

                    <div class="study-modes">
                        <h3>Kies een studiemodus</h3>
                        <div class="modes-grid">
                            <div class="mode-card" onclick="startStudyMode('steps')">
                                <div class="mode-icon">
                                    <i class="fas fa-layer-group"></i>
                                </div>
                                <h4>Stampen</h4>
                                <p>Per 4 woorden: woordkaartjes, meerkeuze en typen</p>
                            </div>
                            <div class="mode-card" onclick="startStudyMode('typing')">
                                <div class="mode-icon">
                                    <i class="fas fa-keyboard"></i>
                                </div>
                                <h4>Typen</h4>
                                <p>Typ alle vertalingen en leer door herhaling</p>
                            </div>
                            <div class="mode-card" onclick="startStudyMode('flashcards')">
                                <div class="mode-icon">
                                    <i class="fas fa-clone"></i>
                                </div>
                                <h4>Woordkaartjes</h4>
                                <p>Swipe door kaartjes en markeer wat je weet</p>
                            </div>
                        </div>
                    </div>

                    <div id="resume-banner" class="resume-banner hidden">
                        <div class="resume-info">
                            <i class="fas fa-play-circle"></i>
                            <span id="resume-text">Je hebt een sessie openstaan.</span>
                        </div>
                        <button class="btn btn-primary" onclick="resumeStudy()">
                            <i class="fas fa-play"></i> Hervatten
                        </button>
                    </div>

                    <div class="words-preview">
                        <div class="words-preview-header">
                            <h3>Woordjes in deze lijst</h3>
                            <button class="btn btn-secondary btn-select-all" onclick="toggleSelectAllWords()">
                                <i class="fas fa-check-double"></i> Selecteer alles
                            </button>
                        </div>
                        <div id="words-preview-list" class="words-preview-list">
                            <!-- Words will be shown here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Study Settings Modal -->
            <div id="settings-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-cog"></i> Instellingen</h3>
                        <button class="btn-close" onclick="closeSettingsModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="setting-group">
                            <label>Vraag richting</label>
                            <div class="direction-selector">
                                <button class="direction-btn active" data-direction="term-def">
                                    <span id="dir-term-def">Term → Definitie</span>
                                </button>
                                <button class="direction-btn" data-direction="def-term">
                                    <span id="dir-def-term">Definitie → Term</span>
                                </button>
                                <button class="direction-btn" data-direction="mixed">
                                    <i class="fas fa-random"></i> Mix
                                </button>
                            </div>
                        </div>

                        <div id="typing-settings" class="typing-settings">
                            <div class="setting-group">
                                <label class="toggle-label">
                                    <input type="checkbox" id="accept-slash-answers" checked>
                                    <span class="toggle-switch">
                                        <span class="toggle-slider"></span>
                                    </span>
                                    <span class="toggle-text">Accepteer beide antwoorden bij "/" (bijv. "licht/fel")</span>
                                </label>
                            </div>
                            <div class="setting-group">
                                <label class="toggle-label">
                                    <input type="checkbox" id="ignore-parentheses" checked>
                                    <span class="toggle-switch">
                                        <span class="toggle-slider"></span>
                                    </span>
                                    <span class="toggle-text">Negeer tekst tussen haakjes</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeSettingsModal()">Annuleren</button>
                        <button class="btn btn-primary" onclick="confirmStartStudy()">
                            <i class="fas fa-play"></i> Start
                        </button>
                    </div>
                </div>
            </div>

            <!-- App Settings Modal -->
            <div id="app-settings-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-cog"></i> Instellingen</h3>
                        <button class="btn-close" onclick="closeAppSettings()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="setting-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="cloud-enabled-toggle">
                                <span class="toggle-switch">
                                    <span class="toggle-slider"></span>
                                </span>
                                <span class="toggle-text">Cloud functies (Supabase) inschakelen</span>
                            </label>
                            <p class="setting-hint">Hiermee krijg je inloggen, openbare lijsten en online sync.</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeAppSettings()">Sluiten</button>
                        <button class="btn btn-primary" onclick="saveAppSettings()">
                            <i class="fas fa-save"></i> Opslaan
                        </button>
                    </div>
                </div>
            </div>

            <!-- Auth Modal -->
            <div id="auth-modal" class="modal hidden cloud-only">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="auth-title"><i class="fas fa-user"></i> Inloggen</h3>
                        <button class="btn-close" onclick="closeAuthModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="auth-email">E-mail</label>
                            <input type="text" id="auth-email" placeholder="jij@mail.com">
                        </div>
                        <div class="form-group">
                            <label for="auth-password">Wachtwoord</label>
                            <input type="password" id="auth-password" placeholder="••••••••">
                        </div>
                        <p id="auth-error" class="auth-error hidden"></p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeAuthModal()">Annuleren</button>
                        <button id="auth-submit-btn" class="btn btn-primary" onclick="submitAuth()">
                            <i class="fas fa-check"></i> Ga door
                        </button>
                    </div>
                </div>
            </div>

            <!-- Study View - Steps Mode -->
            <div id="study-steps-view" class="view study-view">
                <div class="study-container">
                    <div class="study-header">
                        <button class="btn-back" onclick="exitStudy()">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div id="steps-progress" class="progress-fill"></div>
                            </div>
                            <span id="steps-progress-text">0/0</span>
                        </div>
                    </div>

                    <div id="steps-content" class="study-content">
                        <!-- Dynamic content for steps mode -->
                    </div>
                </div>
            </div>

            <!-- Study View - Typing Mode -->
            <div id="study-typing-view" class="view study-view">
                <div class="study-container">
                    <div class="study-header">
                        <button class="btn-back" onclick="exitStudy()">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div id="typing-progress" class="progress-fill"></div>
                            </div>
                            <span id="typing-progress-text">0/0</span>
                        </div>
                    </div>

                    <div id="typing-content" class="study-content">
                        <!-- Dynamic content for typing mode -->
                    </div>
                </div>
            </div>

            <!-- Study View - Flashcards Mode -->
            <div id="study-flashcards-view" class="view study-view">
                <div class="study-container">
                    <div class="study-header">
                        <button class="btn-back" onclick="exitStudy()">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div id="flashcards-progress" class="progress-fill"></div>
                            </div>
                            <span id="flashcards-progress-text">0/0</span>
                        </div>
                    </div>

                    <div id="flashcards-content" class="study-content flashcards-content">
                        <div class="flashcard-wrapper">
                            <div id="flashcard" class="flashcard">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front">
                                        <span id="flashcard-label-front" class="flashcard-label">WOORD</span>
                                        <p id="flashcard-term" class="flashcard-text"></p>
                                        <span class="flashcard-subhint">Tik om te draaien</span>
                                    </div>
                                    <div class="flashcard-back">
                                        <span id="flashcard-label-back" class="flashcard-label">BETEKENIS</span>
                                        <p id="flashcard-definition" class="flashcard-text"></p>
                                    </div>
                                </div>
                            </div>
                            <p class="flashcard-hint">Klik om om te draaien of druk op spatie</p>
                        </div>
                        <div class="flashcard-controls">
                            <button class="btn-flashcard btn-wrong" onclick="markFlashcard(false)">
                                <i class="fas fa-times"></i>
                                <span>Nog leren (←)</span>
                            </button>
                            <button class="btn-flashcard btn-correct" onclick="markFlashcard(true)">
                                <i class="fas fa-check"></i>
                                <span>Goed (→)</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Confetti Canvas -->
            <canvas id="confetti-canvas" class="hidden"></canvas>

            <!-- Completion View -->
            <div id="complete-view" class="view">
                <div class="complete-container">
                    <div class="complete-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2>Gefeliciteerd!</h2>
                    <p id="complete-message">Je hebt alle woordjes geleerd!</p>
                    <div class="complete-stats">
                        <div class="stat">
                            <span class="stat-value" id="stat-correct">0</span>
                            <span class="stat-label">Goed</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="stat-wrong">0</span>
                            <span class="stat-label">Fout</span>
                        </div>
                    </div>
                    <div class="complete-summary" id="complete-summary"></div>
                    <div class="complete-actions">
                        <button class="btn btn-secondary" onclick="showListDetail(currentListId)">
                            <i class="fas fa-arrow-left"></i> Terug naar lijst
                        </button>
                        <button class="btn btn-primary" onclick="restartStudy()">
                            <i class="fas fa-redo"></i> Opnieuw
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Mobile Bottom Navigation Bar -->
        <nav class="mobile-nav">
            <button class="mobile-nav-btn active" onclick="showHome()" data-view="home" aria-label="Home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </button>
            <button class="mobile-nav-btn" onclick="showCreateList()" data-view="create" aria-label="Nieuwe Lijst">
                <i class="fas fa-plus"></i>
                <span>Nieuw</span>
            </button>
            <button class="mobile-nav-btn" onclick="openAppSettings()" data-view="settings" aria-label="Instellingen">
                <i class="fas fa-cog"></i>
                <span>Inst.</span>
            </button>
        </nav>
    </div>

    <!-- Audio Elements -->
    <audio id="correct-sound" preload="auto"></audio>
    <audio id="complete-sound" preload="auto"></audio>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="confetti.js"></script>
    <script src="app.js"></script>
</body>
</html>
